<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ULULATO | Social Weave</title>
    
    <!-- FUENTES & ICONOS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <style>
        /* --- 0. SISTEMA DE DISE칌O --- */
        :root {
            --bg-body: #050505;
            --glass-base: rgba(20, 20, 25, 0.9);
            --glass-border: rgba(255, 255, 255, 0.1);
            --glass-highlight: rgba(255, 255, 255, 0.15);
            --gold: #D4AF37;
            --gold-glow: rgba(212, 175, 55, 0.4);
            --text-main: #ffffff;
            --text-muted: #a0a0a0;
            --font-display: 'Cinzel', serif;
            --font-body: 'Inter', sans-serif;
            --c-yellow: #FFD700; --c-blue: #00BFFF; --c-red: #DC143C; --c-green: #32CD32;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background-color: var(--bg-body); color: var(--text-main); font-family: var(--font-body); overflow-x: hidden; }
        #bg-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; opacity: 0.3; }

        /* --- LAYOUT OPTIMIZADO --- */
        .layout-grid {
            display: grid; 
            /* Ajustado para que quepa mejor en laptops: 250px menu | flexible feed | 300px widgets */
            grid-template-columns: 260px 1fr 300px; 
            gap: 20px;
            max-width: 1300px; margin: 0 auto; padding: 20px; padding-top: 100px;
        }

        /* --- NAVBAR --- */
        .navbar {
            position: fixed; top: 0; left: 0; width: 100%; height: 80px;
            background: rgba(5, 5, 5, 0.95); backdrop-filter: blur(15px);
            border-bottom: 1px solid var(--glass-border);
            z-index: 1000; display: flex; align-items: center; justify-content: space-between;
            padding: 0 30px;
        }
        
        .nav-logo-link { display: flex; align-items: center; text-decoration: none; flex-shrink: 0; }
        .nav-logo-img { height: 50px; width: auto; object-fit: contain; filter: drop-shadow(0 0 5px rgba(212, 175, 55, 0.5)); transition: transform 0.3s; }
        
        .nav-right-area { display: flex; align-items: center; gap: 15px; flex: 1; justify-content: flex-end; position: relative; }

        /* Buscador Animado */
        .search-anim-container {
            width: 0; overflow: hidden; height: 40px;
            transition: width 0.4s cubic-bezier(0.25, 1, 0.5, 1), opacity 0.3s;
            background: rgba(255,255,255,0.1); border-radius: 20px;
            display: flex; align-items: center; opacity: 0;
            border: 1px solid transparent;
        }
        .search-anim-container.active { width: 250px; opacity: 1; border-color: var(--gold); margin-right: 10px; }
        .search-input { width: 100%; background: transparent; border: none; color: #fff; padding: 0 15px; font-family: var(--font-body); outline: none; font-size: 0.9rem; }

        .nav-icons { display: flex; gap: 12px; align-items: center; flex-shrink: 0; }
        
        .nav-icon-btn {
            background: var(--glass-highlight); border: none; color: #fff;
            width: 42px; height: 42px; border-radius: 50%; cursor: pointer;
            transition: 0.3s; display: flex; align-items: center; justify-content: center;
            font-size: 1.2rem; position: relative;
        }
        .nav-icon-btn:hover, .nav-icon-btn.active { background: var(--gold); color: #000; box-shadow: 0 0 15px var(--gold-glow); transform: translateY(-2px); }
        .notification-dot { position: absolute; top: 10px; right: 10px; width: 10px; height: 10px; background: var(--c-red); border-radius: 50%; border: 2px solid #000; animation: pulse 2s infinite; }
        .nav-profile-img { width: 42px; height: 42px; border-radius: 50%; object-fit: cover; border: 2px solid var(--gold); cursor: pointer; transition: 0.3s; margin-left: 10px; }

        /* --- DROPDOWNS --- */
        .dropdown-menu {
            position: absolute; top: 60px; right: 0; width: 320px;
            background: rgba(15, 15, 20, 0.98); backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border); border-radius: 12px;
            padding: 10px; box-shadow: 0 10px 40px rgba(0,0,0,0.6);
            display: none; opacity: 0; transform: translateY(-10px); z-index: 2000;
        }
        .dropdown-menu.open { display: block; } 
        
        .drop-header { padding: 10px; border-bottom: 1px solid var(--glass-border); font-family: var(--font-display); color: var(--gold); font-size: 0.9rem; display: flex; justify-content: space-between; }
        .drop-item { display: flex; gap: 10px; padding: 12px; border-radius: 8px; cursor: pointer; transition: 0.2s; align-items: center; color: #fff; }
        .drop-item:hover { background: var(--glass-highlight); }
        .drop-avatar { width: 35px; height: 35px; border-radius: 50%; object-fit: cover; }
        .drop-text h5 { font-size: 0.9rem; margin: 0; font-weight: 600; }
        .drop-text p { font-size: 0.75rem; color: var(--text-muted); margin: 0; }
        .drop-time { font-size: 0.7rem; color: var(--text-muted); margin-left: auto; }

        /* --- SIDEBAR IZQUIERDA --- */
        .sidebar-left { position: sticky; top: 110px; height: calc(100vh - 120px); }
        .nav-item { display: flex; align-items: center; gap: 15px; padding: 14px 20px; margin-bottom: 8px; border-radius: 16px; text-decoration: none; color: var(--text-muted); font-weight: 500; transition: all 0.3s ease; border: 1px solid transparent; cursor: pointer; position: relative; }
        .nav-item:hover { background: rgba(255,255,255,0.05); color: #fff; transform: translateX(5px); }
        .nav-item.active { background: linear-gradient(90deg, rgba(212, 175, 55, 0.15) 0%, transparent 100%); color: var(--gold); border-left: 3px solid var(--gold); }
        .nav-item i { font-size: 1.5rem; color: #fff; transition: 0.3s; }
        .nav-item.active i { color: var(--gold); }
        /* Asegurar que el texto se vea */
        .nav-text { display: inline-block; white-space: nowrap; }

        /* Loader de Navegaci칩n */
        .page-loader { position: fixed; top: 80px; left: 0; width: 100%; height: 3px; background: transparent; z-index: 2000; pointer-events: none; }
        .loader-bar { width: 0%; height: 100%; background: var(--gold); box-shadow: 0 0 10px var(--gold); transition: width 0.5s ease; }

        /* --- FEED CENTRAL --- */
        #mainContentArea { min-height: 500px; position: relative; width: 100%; }

        .stories-container { display: flex; gap: 15px; margin-bottom: 25px; overflow-x: auto; padding-bottom: 10px; scrollbar-width: none; }
        .story-card { min-width: 110px; height: 180px; border-radius: 15px; position: relative; overflow: hidden; cursor: pointer; border: 1px solid var(--glass-border); transition: 0.3s; background: #111; }
        .story-card:hover { transform: translateY(-5px); box-shadow: 0 5px 20px rgba(0,0,0,0.6); border-color: var(--gold); }
        .story-img { width: 100%; height: 100%; object-fit: cover; opacity: 0.8; transition: 0.5s; }
        .story-card:hover .story-img { opacity: 1; transform: scale(1.05); }
        .story-avatar { position: absolute; top: 10px; left: 10px; width: 35px; height: 35px; border-radius: 50%; border: 2px solid var(--gold); padding: 2px; z-index: 2; }
        .story-avatar img { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; }
        .story-name { position: absolute; bottom: 10px; left: 10px; font-size: 0.8rem; font-weight: 600; text-shadow: 0 2px 5px #000; z-index: 2; }

        /* Estilos Vistas */
        .section-title { font-family: var(--font-display); font-size: 1.8rem; color: var(--gold); margin-bottom: 20px; border-bottom: 1px solid var(--glass-border); padding-bottom: 15px; }
        .market-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; animation: fadeIn 0.5s; }
        .market-card { background: var(--glass-base); border: 1px solid var(--glass-border); border-radius: 15px; overflow: hidden; transition: 0.3s; }
        .market-card:hover { border-color: var(--c-yellow); transform: translateY(-5px); }
        .market-img { width: 100%; height: 150px; object-fit: cover; }
        .market-info { padding: 15px; }
        .market-price { color: var(--c-yellow); font-weight: 700; font-size: 1.1rem; float: right; }
        .wisdom-list { display: flex; flex-direction: column; gap: 15px; animation: fadeIn 0.5s; }
        .wisdom-card { display: flex; gap: 15px; background: var(--glass-base); padding: 15px; border-radius: 15px; border: 1px solid var(--glass-border); align-items: center; transition: 0.3s; }
        .wisdom-card:hover { border-color: var(--c-blue); background: rgba(0, 191, 255, 0.05); }
        .wisdom-thumb { width: 80px; height: 80px; border-radius: 10px; object-fit: cover; }
        .map-placeholder { width: 100%; height: 400px; background: #111; border-radius: 15px; border: 1px solid var(--c-red); position: relative; overflow: hidden; background-image: radial-gradient(#333 1px, transparent 1px); background-size: 20px 20px; animation: fadeIn 0.5s; }
        .map-pin { position: absolute; font-size: 1.5rem; animation: bounce 2s infinite; cursor: pointer; }

        /* Estilos CONFIGURACI칍N */
        .settings-container { animation: fadeIn 0.5s; }
        .settings-group { background: var(--glass-base); border-radius: 15px; border: 1px solid var(--glass-border); padding: 25px; margin-bottom: 20px; }
        .settings-header { font-family: var(--font-display); color: #fff; margin-bottom: 20px; font-size: 1.1rem; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px; }
        .setting-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .setting-label h5 { margin: 0; font-size: 1rem; }
        .setting-label p { margin: 0; font-size: 0.8rem; color: var(--text-muted); }
        /* Toggle Switch */
        .switch { position: relative; display: inline-block; width: 50px; height: 26px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(255,255,255,0.2); transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--gold); }
        input:checked + .slider:before { transform: translateX(24px); background-color: #000; }
        .setting-input { width: 100%; background: rgba(0,0,0,0.3); border: 1px solid var(--glass-border); padding: 12px; border-radius: 8px; color: #fff; margin-top: 5px; outline: none; }
        .setting-input:focus { border-color: var(--gold); }

        /* Composer */
        .loom-box { background: var(--glass-base); border-radius: 16px; padding: 20px; border: 1px solid var(--glass-border); margin-bottom: 30px; }
        .loom-top { display: flex; gap: 15px; align-items: center; margin-bottom: 15px; }
        .loom-input { width: 100%; background: rgba(0,0,0,0.3); border: none; padding: 15px; border-radius: 25px; color: #fff; outline: none; transition: 0.3s; }
        .loom-actions { display: flex; justify-content: space-between; border-top: 1px solid var(--glass-border); padding-top: 15px; }
        .tool-btn { background: transparent; border: none; color: var(--text-muted); display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 12px; border-radius: 8px; transition: 0.3s; }
        .btn-weave { background: var(--gold); color: #000; border: none; padding: 6px 20px; border-radius: 20px; font-weight: 700; font-size: 0.85rem; font-family: var(--font-display); cursor: pointer; transition: 0.3s; letter-spacing: 1px; }

        /* POSTS */
        .feed-node { background: var(--glass-base); border-radius: 16px; border: 1px solid var(--glass-border); margin-bottom: 25px; overflow: hidden; animation: slideUp 0.5s ease-out; }
        .node-header { padding: 15px 20px; display: flex; align-items: center; justify-content: space-between; }
        .node-author { display: flex; align-items: center; gap: 12px; }
        .author-img { width: 45px; height: 45px; border-radius: 50%; object-fit: cover; }
        .node-category { font-size: 0.7rem; text-transform: uppercase; padding: 4px 10px; border-radius: 20px; border: 1px solid currentColor; font-weight: 600; }
        .node-body { padding: 0 20px 15px; font-size: 0.95rem; line-height: 1.5; color: #eee; }
        .node-media { width: 100%; display: block; margin-top: 15px; border-radius: 8px; border: 1px solid var(--glass-border); }
        .node-actions { padding: 10px 20px; border-top: 1px solid var(--glass-border); display: flex; justify-content: space-around; }
        
        .action-item { 
            background: none; border: none; color: var(--text-muted); 
            display: flex; align-items: center; gap: 8px; cursor: pointer; 
            padding: 8px 20px; border-radius: 8px; transition: 0.3s; 
            font-size: 0.9rem; font-weight: 500; width: 100%; justify-content: center; 
        }
        .action-item:hover { background: var(--glass-highlight); color: #fff; }
        .action-item.active { color: #fff; } 
        
        /* ICONO PERSONALIZADO */
        .custom-icon { width: 24px; height: 24px; fill: none; stroke: currentColor; stroke-width: 2; overflow: visible; display: flex; }
        .feather-body { d: path("M20.5,3.5 c0,0-1.5,8-9,13 s-8,4-8,4 l1.5,1.5 c0,0,3-0.5,8-4 s9-14.5,9-14.5 Z"); }
        .feather-spine { d: path("M20.5,3.5 C20.5,3.5 12,12 8,20"); }
        .heart-mini { transform: translate(3px, -3px); fill: currentColor; stroke: none; opacity: 0.8; }
        
        .action-item.active .feather-body { stroke: var(--gold); fill: rgba(212, 175, 55, 0.1); } 
        .action-item.active .feather-spine { stroke: var(--gold); }
        .action-item.active .heart-mini { fill: var(--c-red); animation: heartbeat 0.6s infinite; }

        .node-comments { background: rgba(0,0,0,0.2); padding: 15px 20px; display: none; border-top: 1px solid var(--glass-border); }
        .node-comments.open { display: block; animation: fadeIn 0.3s; }
        .comment-input { width: 100%; background: rgba(255,255,255,0.05); border: 1px solid var(--glass-border); border-radius: 20px; padding: 8px 15px; color: #fff; outline: none; }
        .comment-item { display: flex; gap: 10px; margin-bottom: 10px; font-size: 0.9rem; }
        .comment-bubble { background: rgba(255,255,255,0.1); padding: 8px 12px; border-radius: 12px; }

        /* --- SIDEBAR DER --- */
        .sidebar-right { position: sticky; top: 110px; height: calc(100vh - 120px); }
        .widget { background: var(--glass-base); border-radius: 16px; padding: 20px; border: 1px solid var(--glass-border); margin-bottom: 20px; }
        .widget-title { font-family: var(--font-display); font-size: 1rem; color: var(--text-muted); margin-bottom: 15px; border-bottom: 1px solid var(--glass-border); padding-bottom: 10px; }
        .trend-item { display: flex; align-items: center; gap: 10px; margin-bottom: 15px; cursor: pointer; transition: 0.3s; }
        .trend-item:hover .trend-info h5 { color: var(--gold); }
        .follow-btn { background: var(--glass-highlight); border: none; color: var(--gold); width: 32px; height: 32px; border-radius: 50%; cursor: pointer; transition: 0.3s; display: flex; align-items: center; justify-content: center; }
        .follow-btn.following { background: rgba(50, 205, 50, 0.2); color: var(--c-green); }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes heartbeat { 0% { transform: scale(1); } 50% { transform: scale(1.3); } 100% { transform: scale(1); } }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        /* Media Queries Ajustados */
        @media (max-width: 1200px) { .layout-grid { grid-template-columns: 80px 1fr 280px; } .nav-text { display: none; } }
        @media (max-width: 900px) { .layout-grid { grid-template-columns: 80px 1fr; } .sidebar-right { display: none; } }
    </style>
</head>
<body>

    <!-- FONDO -->
    <canvas id="bg-canvas"></canvas>
    <div class="page-loader"><div class="loader-bar" id="pageLoader"></div></div>

    <!-- NAVBAR -->
    <nav class="navbar">
        <a href="#" class="nav-logo-link">
            <img src="https://pub-8275440e24554b96ad7dd640df0866b9.r2.dev/imagenes/Logo.png" alt="Ululato" class="nav-logo-img">
        </a>
        
        <div class="nav-right-area">
            <div class="search-anim-container" id="searchAnimBox">
                <input type="text" class="search-input" id="searchInput" placeholder="Buscar...">
            </div>
            <div class="nav-icons">
                <button class="nav-icon-btn" onclick="toggleSearch()" title="Buscar"><i class="ph ph-magnifying-glass"></i></button>
                
                <button class="nav-icon-btn" onclick="toggleDropdown('msgDropdown')" title="Mensajes">
                    <i class="ph ph-chat-circle-text"></i>
                </button>
                
                <button class="nav-icon-btn" id="notifBtn" onclick="toggleDropdown('notifDropdown'); clearNotification(this);" title="Notificaciones">
                    <i class="ph ph-bell"></i>
                    <span class="notification-dot"></span>
                </button>
                
                <img src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?auto=format&fit=crop&w=100" class="nav-profile-img" title="Mi Perfil" onclick="loadView('Config')">
            </div>
            
            <!-- MEN칔S FLOTANTES -->
            <div id="msgDropdown" class="dropdown-menu" style="right: 60px;">
                <div class="drop-header"><span>Mensajes</span> <i class="ph ph-envelope-open"></i></div>
                <div class="drop-item">
                    <img src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=100" class="drop-avatar">
                    <div class="drop-text"><h5>Ana Wayuu</h5><p>쮸칰n tienes mochilas?</p></div>
                    <span class="drop-time">2m</span>
                </div>
            </div>

            <div id="notifDropdown" class="dropdown-menu" style="right: 10px;">
                <div class="drop-header"><span>Notificaciones</span> <i class="ph ph-bell"></i></div>
                <div class="drop-item">
                    <div style="width:35px; height:35px; border-radius:50%; background:var(--glass-highlight); display:flex; align-items:center; justify-content:center; color:var(--c-blue);"><i class="ph ph-thumbs-up"></i></div>
                    <div class="drop-text" style="margin-left:10px;"><h5>A Carlos le gusta</h5><p>tu nuevo tejido.</p></div>
                </div>
            </div>
        </div>
    </nav>

    <!-- LAYOUT -->
    <div class="layout-grid">
        
        <!-- IZQUIERDA -->
        <aside class="sidebar-left">
            <div class="nav-item active" onclick="loadView('Inicio', this)" title="Muro principal"><i class="ph ph-house"></i> <span class="nav-text">Inicio</span></div>
            <div class="nav-item" onclick="loadView('Comunidad', this)" title="Red de contactos"><i class="ph ph-users-three"></i> <span class="nav-text">Comunidad</span></div>
            <div class="nav-item" onclick="loadView('Mercado', this)" title="Trueques y ventas"><i class="ph ph-storefront"></i> <span class="nav-text">Mercado</span></div>
            <div class="nav-item" onclick="loadView('Sabiduria', this)" title="Cursos"><i class="ph ph-graduation-cap"></i> <span class="nav-text">Sabidur칤a</span></div>
            <div class="nav-item" onclick="loadView('Territorio', this)" title="Mapas"><i class="ph ph-map-trifold"></i> <span class="nav-text">Territorio</span></div>
            <div style="margin: 20px 0; border-top: 1px solid var(--glass-border);"></div>
            <div class="nav-item" onclick="loadView('Config', this)" title="Configuraci칩n"><i class="ph ph-gear"></i> <span class="nav-text">Configuraci칩n</span></div>
        </aside>

        <!-- CENTRO (CONENIDO ESTATICO PARA EVITAR PANTALLA NEGRA AL INICIO) -->
        <main class="feed-column" id="mainContentArea">
            
            <div class="stories-container">
                <div class="story-card" style="min-width: 110px;">
                    <img src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=200" class="story-img" style="filter: brightness(0.6);">
                    <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); width:35px; height:35px; background:var(--gold); border-radius:50%; display:flex; align-items:center; justify-content:center; color:#000;"><i class="ph ph-plus-bold"></i></div>
                    <span class="story-name">Crear Visi칩n</span>
                </div>
                <div class="story-card"><img src="https://images.unsplash.com/photo-1571210059434-edf0dc48e414?w=200" class="story-img"><div class="story-avatar"><img src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=100"></div><span class="story-name">Ana Wayuu</span></div>
                <div class="story-card"><img src="https://images.unsplash.com/photo-1605218427368-35b8206d09d6?w=200" class="story-img"><div class="story-avatar"><img src="https://images.unsplash.com/photo-1599566150163-29194dcaad36?w=100"></div><span class="story-name">Artesan칤as Kai</span></div>
            </div>

            <div class="loom-box">
                <div class="loom-top"><img src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=100" class="nav-profile-img" style="margin:0;"><input type="text" class="loom-input" id="postInput" placeholder="쯈u칠 hebra quieres tejer hoy?"></div>
                <div class="loom-actions">
                    <div class="loom-tools"><button class="tool-btn"><i class="ph ph-image" style="color:#4facfe"></i> Foto</button><button class="tool-btn"><i class="ph ph-tag" style="color:#fe5196"></i> Etiquetar</button></div>
                    <button class="btn-weave" onclick="createPost()">TEJER</button>
                </div>
            </div>

            <div id="feed-container">
                <article class="feed-node">
                    <div class="node-header">
                        <div class="node-author"><img src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=100" class="author-img"><div class="author-info"><h4>Ana Wayuu</h4><span>Hace 2 lunas</span></div></div>
                        <span class="node-category" style="color:var(--c-blue);border-color:var(--c-blue);">Sabidur칤a</span>
                    </div>
                    <div class="node-body">La conexi칩n entre nuestros tejidos y el c칩digo digital es profunda. 游깳<img src="https://images.unsplash.com/photo-1616628188550-808682f3926d?w=800" class="node-media"></div>
                    <div class="node-actions">
                        <button class="action-item" onclick="toggleReaction(this)"><svg class="custom-icon" viewBox="0 0 24 24"><path class="feather-body" d="M20.5,3.5 c0,0-1.5,8-9,13 s-8,4-8,4 l1.5,1.5 c0,0,3-0.5,8-4 s9-14.5,9-14.5 Z" stroke-linejoin="round" stroke-linecap="round"></path><path class="feather-spine" d="M20.5,3.5 C20.5,3.5 12,12 8,20" stroke-linejoin="round" stroke-linecap="round"></path><path class="heart-mini" d="M19 13c-1.5 0-2.5 1-2.5 1S15.5 13 14 13c-2 0-3 2-3 4s4 6 5.5 7c1.5-1 5.5-3 5.5-7s-1-4-3-4z"></path></svg> Resonar</button>
                        <button class="action-item"><i class="ph ph-chat-circle"></i> Comentarios (1)</button>
                        <button class="action-item"><i class="ph ph-share-network"></i> Compartir tejido</button>
                    </div>
                </article>
            </div>

        </main>

        <!-- DERECHA -->
        <aside class="sidebar-right">
            <div class="widget">
                <h5 class="widget-title">HILOS TENDENCIA</h5>
                <div class="trend-item"><div style="width:40px; height:40px; background:rgba(255,255,255,0.05); border-radius:10px; display:flex; align-items:center; justify-content:center; color:var(--gold);"><i class="ph ph-hash"></i></div><div class="trend-info"><h5>TejidoDigital</h5><span style="font-size:0.7rem; color:var(--text-muted);">1.2k hebras</span></div></div>
                <div class="trend-item"><div style="width:40px; height:40px; background:rgba(255,255,255,0.05); border-radius:10px; display:flex; align-items:center; justify-content:center; color:var(--gold);"><i class="ph ph-hash"></i></div><div class="trend-info"><h5>AltaGuajira</h5><span style="font-size:0.7rem; color:var(--text-muted);">850 hebras</span></div></div>
                <div class="trend-item"><div style="width:40px; height:40px; background:rgba(255,255,255,0.05); border-radius:10px; display:flex; align-items:center; justify-content:center; color:var(--gold);"><i class="ph ph-hash"></i></div><div class="trend-info"><h5>Originarios</h5><span style="font-size:0.7rem; color:var(--text-muted);">600 hebras</span></div></div>
            </div>
            <div class="widget">
                <h5 class="widget-title">SUGERENCIAS</h5>
                <div class="trend-item">
                    <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=100" style="width:40px; height:40px; border-radius:50%; object-fit:cover;">
                    <div class="trend-info" style="flex:1;"><h5>Mateo Pushaina</h5><span style="font-size:0.7rem; color:var(--text-muted);">L칤der</span></div>
                    <button class="follow-btn" onclick="toggleFollow(this)"><i class="ph ph-plus"></i></button>
                </div>
                <div class="trend-item">
                    <img src="https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=100" style="width:40px; height:40px; border-radius:50%; object-fit:cover;">
                    <div class="trend-info" style="flex:1;"><h5>Artesan칤as Kai</h5><span style="font-size:0.7rem; color:var(--text-muted);">Tienda</span></div>
                    <button class="follow-btn" onclick="toggleFollow(this)"><i class="ph ph-plus"></i></button>
                </div>
            </div>
        </aside>
    </div>

    <!-- SCRIPTS -->
    <script>
        // 1. ANIMACI칍N FONDO
        const canvas = document.getElementById('bg-canvas'); const ctx = canvas.getContext('2d');
        let w, h, particles = [];
        function initCanvas() { w = canvas.width = window.innerWidth; h = canvas.height = window.innerHeight; particles = Array(50).fill().map(() => ({ x: Math.random() * w, y: Math.random() * h, len: Math.random() * 100 + 50, speed: Math.random() * 2 + 1, alpha: Math.random() * 0.5 })); }
        function animCanvas() { ctx.clearRect(0, 0, w, h); ctx.strokeStyle = '#D4AF37'; particles.forEach(p => { ctx.globalAlpha = p.alpha; ctx.beginPath(); ctx.moveTo(p.x, p.y); ctx.lineTo(p.x, p.y + p.len); ctx.stroke(); p.y += p.speed; if (p.y > h) { p.y = -p.len; p.x = Math.random() * w; } }); requestAnimationFrame(animCanvas); }
        window.addEventListener('resize', initCanvas); initCanvas(); animCanvas();

        // 2. INTERACCIONES
        function toggleSearch() {
            const container = document.getElementById('searchAnimBox');
            const input = document.getElementById('searchInput');
            container.classList.toggle('active');
            if(container.classList.contains('active')) input.focus();
        }

        function toggleDropdown(id) {
            const el = document.getElementById(id);
            document.querySelectorAll('.dropdown-menu').forEach(d => { if(d.id !== id) { d.style.display = 'none'; d.classList.remove('open'); }});
            if(el.classList.contains('open')) {
                gsap.to(el, { opacity: 0, y: -10, duration: 0.2, onComplete: () => { el.style.display='none'; el.classList.remove('open'); }});
            } else {
                el.style.display = 'block';
                gsap.fromTo(el, {opacity:0, y:-10}, {opacity:1, y:0, duration:0.3});
                el.classList.add('open');
            }
        }
        function clearNotification(btn) { btn.querySelector('.notification-dot').style.display='none'; }
        function toggleFollow(btn) { const icon=btn.querySelector('i'); if(icon.classList.contains('ph-plus')) { icon.classList.replace('ph-plus','ph-check'); btn.classList.add('following'); } else { icon.classList.replace('ph-check','ph-plus'); btn.classList.remove('following'); } }

        // 3. VISTAS (HTML STRING) - Solo se usa al navegar
        const views = {
            'Inicio': document.getElementById('mainContentArea').innerHTML, // Guardamos la inicial
            
            'Config': `
                <div class="settings-container">
                    <h2 class="section-title">Ajustes de Cuenta</h2>
                    <div class="settings-group">
                        <div class="settings-header">Mi Identidad</div>
                        <div class="setting-row">
                            <div class="setting-label"><h5>Nombre de Tejedor</h5><p>Como te ven los dem치s</p></div>
                            <div style="width:50%"><input type="text" class="setting-input" value="Usuario Ululato"></div>
                        </div>
                    </div>
                    <div class="settings-group">
                        <div class="settings-header">Preferencias</div>
                        <div class="setting-row">
                            <div class="setting-label"><h5>Notificaciones</h5><p>Recibir ecos</p></div>
                            <label class="switch"><input type="checkbox" checked><span class="slider"></span></label>
                        </div>
                    </div>
                </div>`,
            'Mercado': `<h2 class="section-title">Mercado</h2><div class="market-grid"><div class="market-card"><img src="https://images.unsplash.com/photo-1596263576925-50e5b7294fb8?w=400" class="market-img"><div class="market-info"><h4>Mochila</h4><p style="color:#aaa;">Hilo original.</p><span class="market-price">$120k</span></div></div></div>`,
            'Territorio': `<h2 class="section-title">Mapa Ancestral</h2><div class="map-placeholder"><i class="ph ph-map-pin-fill map-pin" style="top:40%;left:30%;color:var(--c-red)"></i></div>`,
            'Sabiduria': `<h2 class="section-title">Saberes</h2><div class="wisdom-list"><div class="wisdom-card"><h4>Curso B치sico</h4><p>Aprende tejido.</p></div></div>`,
            'Comunidad': `<h2 class="section-title">Comunidad</h2><p style="color:#888;">Cargando red...</p>`
        };

        function loadView(name, btn) {
            if(btn) { document.querySelectorAll('.nav-item').forEach(e=>e.classList.remove('active')); btn.classList.add('active'); }
            const main = document.getElementById('mainContentArea');
            const loader = document.getElementById('pageLoader');
            loader.style.width='70%';
            gsap.to(main, {opacity:0, y:10, duration:0.2, onComplete:()=>{
                main.innerHTML = views[name] || views['Inicio'];
                gsap.fromTo(main, {opacity:0, y:10}, {opacity:1, y:0, duration:0.4});
                loader.style.width='100%'; setTimeout(()=>{loader.style.width='0%'},300);
            }});
        }

        // 4. FUNCIONALIDAD POST
        function createPost() {
            const input = document.getElementById('postInput');
            if(!input.value.trim()) return;
            const html = `
                <article class="feed-node">
                    <div class="node-header">
                        <div class="node-author"><img src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=100" class="author-img"><div class="author-info"><h4>T칰</h4><span>Hace un instante</span></div></div>
                        <span class="node-category" style="color:var(--c-blue);border-color:var(--c-blue);">Sabidur칤a</span>
                    </div>
                    <div class="node-body">${input.value}</div>
                    <div class="node-actions">
                        <button class="action-item" onclick="toggleReaction(this)"><svg class="custom-icon" viewBox="0 0 24 24"><path class="feather-body" d="M20.5,3.5 c0,0-1.5,8-9,13 s-8,4-8,4 l1.5,1.5 c0,0,3-0.5,8-4 s9-14.5,9-14.5 Z" stroke-linejoin="round" stroke-linecap="round"></path><path class="feather-spine" d="M20.5,3.5 C20.5,3.5 12,12 8,20" stroke-linejoin="round" stroke-linecap="round"></path><path class="heart-mini" d="M19 13c-1.5 0-2.5 1-2.5 1S15.5 13 14 13c-2 0-3 2-3 4s4 6 5.5 7c1.5-1 5.5-3 5.5-7s-1-4-3-4z"></path></svg> Resonar</button>
                        <button class="action-item"><i class="ph ph-chat-circle"></i> Comentarios</button>
                        <button class="action-item"><i class="ph ph-share-network"></i> Compartir tejido</button>
                    </div>
                </article>`;
            document.querySelector('.loom-box').insertAdjacentHTML('afterend', html);
            input.value = '';
        }

        window.toggleReaction = function(btn) { 
            btn.classList.toggle('active');
            if(btn.classList.contains('active')) {
                gsap.fromTo(btn.querySelector('.heart-mini'), {scale: 0}, {scale: 1, duration: 0.4, ease: "elastic.out(1, 0.3)"});
            }
        }
    </script>
</body>
</html>